<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Dynamic Photo Gallery</title>
    <link rel="stylesheet" href="index.css" />
    <script type="module">
      import "/components/photo-gallery.js";

      const photoGallery = document.getElementById("photo-gallery");
      photoGallery.focus();

      const renderItem = ({ image, fact }) => {
        return `
        <wc-photo-gallery-item
          image="${image}"
          fact="${fact}"
        >
        </wc-photo-gallery-item>
        `;
      };

      const render = (items) => {
        return items.map((item) => renderItem(item)).join("");
      };

      const fetchCats = async () => {
        const response = await fetch("/api/cats");
        const json = await response.json();
        return json;
      }

      (async () => {
        const json = await fetchCats();
        photoGallery.insertAdjacentHTML("afterbegin", render(json));
      })();

      photoGallery.addEventListener("prev", async () => {
        const json = await fetchCats();
        photoGallery.index = photoGallery.index + json.length + 1;
        photoGallery.insertAdjacentHTML("beforeend", render(json));
      });

      photoGallery.addEventListener("next", async () => {
        const json = await fetchCats();
        photoGallery.insertAdjacentHTML("afterbegin", render(json));
      });
    </script>
  </head>

  <body>
    <wc-photo-gallery id="photo-gallery" tabindex="0">
    </wc-photo-gallery>
  </body>
</html>
